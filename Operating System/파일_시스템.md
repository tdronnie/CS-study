# 파일_시스템
파일 시스템은 OS에서 데이터를 저장하고 관리하는 방식이다.

저장장치(HDD, SSD등)에 파일을 저장하고 파일을 효과적으로 관리하기 위해서 디렉토리(계층)와 같은 구조를 사용한다.

파일의 CRUD 기능을 제공한다.

커널 영역에서 동작한다.

-> 커널은 파일 시스템에 대한 인터페이스를 제공해서 사용자가 파일을 사용할 수 있도록 한다.
    파일 시스템은 디스크에서 데이터를 읽고 쓰는 것과 같은 하드웨어 부분과 파일 및 디렉토리 구조를 관리하는 소프트웨어 부분으로 구성되는데 이런 요소들은 OS의 커널 내부에 위치한다.
    파일에 엑세스하는 데 필요한 작업을 수행한다. 
    운영체제의 일부로써 커널 수준에서 동작한다.

디스크 파티션 별로 하나씩 둘 수 있다.

HDD와 메인메모리 속도차를 줄이고 HDD 용량을 효율적으로 이용하기 위해서 개발되었다.

파일과 관련한 정보를 담는 메타 영역과 파일의 데이터를 담는 데이터 영역이 있다.

---
## 접근 방법

### 순차 접근
가장 간단한 접근방식

현재 위치를 가리키는 포인터가 있고 시스템 콜이 발생할 경우 포인터 앞으로 보내면 read and write 하거나 포인터 뒤로 돌아가면서 지정한 offset만큼 되감기를 한다.


### 직접 접근
순서 없이 빠르게 read and write 가능

현재 포인터 변수를 유지하면서 직접 접근 파일을 가지고 순차 파일기능을 사용한다
무작위 파일 블록에 대한 임의 접근이 가능하다. 순서에 제약이 없다.

```
   reset        <->         cp = 0
   read_next    <->         read cp; cp = cp + 1; #이런 식으로 현재위치에 대한 포인터 활용
```
대규모 정보를 접근할 때 유용해서 DB에 활용된다.

### 기타 접근
직접 접근에 기반한다.

인덱스 파일을 활용해 연관된 파일에 접근하는 방법이 있다.

---
## 디렉토리와 디스크 구조의 관계

파일 시스템에서는 논리적인 디렉토리 구조와 물리적인 블록 구조가 연결된다.

일반적으로 파일 시스템은 파일과 디렉토리를 블록 단위로 저장한다. 각 블록에 파일, 디렉토리의 데이터와 메타 데이터가 저장된다.

논리적인 디렉토리 구조는 디렉토리와 파일 간의 계층구조를 말하는데 사용자에게 보여지고 사용할 수 있게 해준다.

물리적 구조는 파일 시스템에서 블록들이 저장되는 구조이다. 일반적으로 블록은 저장장치에서 연속적으로 공간을 차지한다.

논리적 계층은 물리적 블록의 구성으로 표현된다. 이런 블록들은 메타영역의 데이터 중 하나인 파일할당데이터에서 관리된다.

### 디렉토리 1단계
모든 사용자 통틀어서 파일이 고유이름 가져야 함(한 디렉토리 - 한 파일)

### 디렉토리 2단계
사용자에게 개별적인 디렉토리 사용이 가능하다(한 디렉토리 - 한 파일)

### 트리구조 디렉토리
2단계에서 확장된 다단계 트리구조, 한 비트 이용해서 일반 파일과(0) 디렉토리 파일(1) 구분

### 그래프 구조 디렉토리
파일 간 순환이 발생하지 않도록 파일에 대한 링크만 허용하거나 가비지 컬렉션을 이용해 전체 파일 시스템을 순회하고 접근 가능한 것을 표시한다.

링크를 이용하면 아예 다른 쪽으로 우회시켜 순환을 피할 수 있다.



### 참고

https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Operating%20System/File%20System.md